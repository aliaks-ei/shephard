// Space Grotesk Font
@font-face {
  font-family: 'Space Grotesk';
  src: url('../assets/fonts/SpaceGrotesk/SpaceGrotesk-Light.woff') format('woff');
  font-weight: 300;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: 'Space Grotesk';
  src: url('../assets/fonts/SpaceGrotesk/SpaceGrotesk-Regular.woff') format('woff');
  font-weight: 400;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: 'Space Grotesk';
  src: url('../assets/fonts/SpaceGrotesk/SpaceGrotesk-Medium.woff') format('woff');
  font-weight: 500;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: 'Space Grotesk';
  src: url('../assets/fonts/SpaceGrotesk/SpaceGrotesk-SemiBold.woff') format('woff');
  font-weight: 600;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: 'Space Grotesk';
  src: url('../assets/fonts/SpaceGrotesk/SpaceGrotesk-Bold.woff') format('woff');
  font-weight: 700;
  font-style: normal;
  font-display: swap;
}

@import './theme.scss';

html {
  background-color: $bg-color;
  color: $text-color;
  padding: env(safe-area-inset-top, 0px) env(safe-area-inset-right, 0px) 0
    env(safe-area-inset-left, 0px);
}

html:has(.body--dark) {
  background-color: $dark-page;
}

body {
  font-family:
    'Space Grotesk',
    -apple-system,
    BlinkMacSystemFont,
    'Roboto Slab',
    'Droid Serif',
    'Segoe UI',
    Georgia,
    'Times New Roman',
    serif;
  min-height: 100vh;
  min-height: 100dvh;
  background: hsl(var(--background));
  color: hsl(var(--foreground));
  letter-spacing: var(--tracking-tight);
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#q-app,
.q-layout {
  min-height: 100vh;
  min-height: 100dvh;
}

// Global Dialog Styles - Consistent 480px width on desktop
.q-dialog__inner > .q-card {
  width: 90vw;
  min-width: 300px;
  border-radius: var(--radius-lg);
  background: hsl(var(--card));
  color: hsl(var(--card-foreground));
  box-shadow: var(--shadow-lg);
  border: var(--border-width) solid var(--border-color);

  @media (min-width: $breakpoint-sm-min) {
    width: 480px;
    max-width: 90vw;
  }
}

.q-drawer,
.q-drawer__content {
  background: hsl(var(--card));
  color: hsl(var(--card-foreground));
}

// Global Notification Styles - Full width on mobile with bottom offset for navigation
.q-notification {
  width: 100%;
  margin-bottom: calc(72px + env(safe-area-inset-bottom, 0px));

  @media (min-width: $breakpoint-sm-min) {
    width: auto;
    margin-bottom: 0;
  }
}

// Safe Area Bottom Padding - Reusable class for iOS PWA bottom spacing
.safe-area-bottom {
  padding-bottom: max(8px, calc(8px + env(safe-area-inset-bottom, 0px)));
}

// Shared page and section spacing utilities
.item-amount-section {
  max-width: 80px;

  @media (min-width: $breakpoint-md-min) {
    max-width: 112px;
  }
}

.page-content-spacing {
  padding: var(--page-content-padding-mobile);

  @media (min-width: $breakpoint-md-min) {
    padding: var(--page-content-padding-desktop);
  }
}

.section-spacing {
  margin-bottom: var(--section-spacing-mobile);

  @media (min-width: $breakpoint-md-min) {
    margin-bottom: var(--section-spacing-desktop);
  }
}

.section-spacing-compact {
  margin-bottom: var(--section-spacing-compact-mobile);

  @media (min-width: $breakpoint-md-min) {
    margin-bottom: var(--section-spacing-desktop);
  }
}

// Mobile expense swipe rows: remove red edge artifact and add breathing room on the right.
.mobile-expense-swipe-item .q-slide-item__right {
  margin: 1px;
}

.mobile-expense-swipe-item .q-slide-item__content {
  box-sizing: border-box;
  padding-right: 4px;
}

// --------------------------------------------
// Buttons (q-btn) - shadcn-vue conventions
// --------------------------------------------
.q-btn {
  border-radius: var(--radius-md); // 6px
  font-weight: 500;
  letter-spacing: var(--tracking-tight);
  text-transform: none;
  transition:
    background-color 0.15s ease,
    border-color 0.15s ease,
    color 0.15s ease,
    box-shadow 0.15s ease;

  // Default variant - no shadow on buttons (shadcn pattern)
  &:not(.q-btn--flat):not(.q-btn--outline) {
    box-shadow: none;
  }

  // Outline variant
  &.q-btn--outline {
    border-width: var(--border-width);
    box-shadow: var(--shadow-xs);

    &:hover {
      background: var(--muted);
    }
  }

  // Focus ring - 3px with 50% opacity
  &:focus-visible {
    outline: none;
    box-shadow: 0 0 0 3px hsl(var(--ring) / 0.5);
  }

  &.q-btn--round {
    border-radius: var(--radius-full);
  }
}

// --------------------------------------------
// Cards (q-card) - shadcn-vue conventions
// --------------------------------------------
.q-card {
  border-radius: var(--radius-xl); // 12px (shadcn uses rounded-xl)
  background: hsl(var(--card));
  color: hsl(var(--card-foreground));
  border: 1px solid hsl(var(--border));
  transition:
    box-shadow 0.15s ease,
    border-color 0.15s ease;

  &:not(.q-card--flat) {
    box-shadow: var(--shadow-sm);
  }

  &.q-card--bordered {
    border: var(--border-width) solid var(--border-color);
  }

  &.q-card--flat {
    box-shadow: none;
    border: 1px solid hsl(var(--border));
  }

  // Cards with no-shadow should also have no border
  &.no-shadow,
  &.shadow-0 {
    box-shadow: none;
    border: none;
  }

  .q-card__section {
    &:first-child {
      border-radius: var(--radius-xl) var(--radius-xl) 0 0;
    }

    &:last-child {
      border-radius: 0 0 var(--radius-xl) var(--radius-xl);
    }

    &:only-child {
      border-radius: var(--radius-xl);
    }
  }

  .q-card__actions {
    border-top: var(--border-width) solid var(--border-color-subtle);
  }
}

// --------------------------------------------
// Form Fields (q-field, q-input, q-select) - shadcn-vue conventions
// --------------------------------------------
.q-field {
  &--outlined {
    .q-field__control {
      border-radius: var(--radius-md); // 6px
      background: hsl(var(--popover));
      border: var(--border-width) solid var(--border-color);
      box-shadow: var(--shadow-xs);
      transition:
        border-color 0.15s ease,
        box-shadow 0.15s ease;

      &::before {
        border: none;
      }

      &::after {
        border: none;
      }

      // Focus state - 3px ring with 50% opacity
      &:focus-within {
        border-color: var(--ring-color-primary);
        box-shadow: 0 0 0 3px hsl(var(--ring) / 0.5);
      }
    }

    &.q-field--readonly .q-field__control {
      border: none;

      &::before {
        border: 1px dashed var(--border-color-readonly);
        border-radius: var(--radius-md);
      }
    }

    &.q-field--error .q-field__control {
      border-color: $negative;
    }

    &.q-field--focused.q-field--error .q-field__control {
      box-shadow: 0 0 0 3px hsl(var(--destructive) / 0.2);
    }
  }

  &--filled {
    .q-field__control {
      border-radius: var(--radius-md); // 6px
      background: var(--muted);
      border: var(--border-width) solid transparent;
      box-shadow: var(--shadow-xs);
      transition:
        border-color 0.15s ease,
        box-shadow 0.15s ease;

      &::before {
        background: transparent;
      }

      // Focus state - 3px ring with 50% opacity
      &:focus-within {
        border-color: var(--ring-color-primary);
        box-shadow: 0 0 0 3px hsl(var(--ring) / 0.5);
      }
    }

    &.q-field--readonly .q-field__control {
      border: none;

      &::before {
        border: 1px dashed var(--border-color-readonly);
        border-radius: var(--radius-md);
        background: transparent;
      }
    }
  }

  .q-field__label {
    font-weight: 500;
  }

  .q-field__native {
    letter-spacing: var(--tracking-tight);
  }

  .q-field__native,
  .q-field__input,
  .q-field__marginal,
  .q-select__dropdown-icon {
    color: hsl(var(--foreground));
  }
}

// --------------------------------------------
// Dropdowns/Menus (q-menu) - shadcn-vue conventions
// --------------------------------------------
.q-menu {
  border-radius: var(--radius-md); // 6px
  border: 1px solid hsl(var(--border));
  background: hsl(var(--popover));
  color: hsl(var(--popover-foreground));
  box-shadow: var(--shadow-md);
  padding: 4px;

  .q-item {
    border-radius: var(--radius-sm); // 4px
    margin: 0;
    color: inherit;

    .q-item__section,
    .q-item__label {
      color: inherit;
    }

    &:hover {
      background: var(--muted);
    }

    &.q-item--active {
      background: var(--muted);
    }
  }
}

.body--dark {
  .q-dialog__inner > .q-card {
    background: hsl(var(--background));
    color: hsl(var(--foreground));
  }

  .q-card:not(.q-card--flat),
  .q-card.shadow-1 {
    box-shadow: var(--shadow-xs) !important;
  }

  .q-field--outlined .q-field__control,
  .q-field--filled .q-field__control {
    background: rgba(255, 255, 255, 0.045);
  }

  .q-select .q-field__control {
    background: hsl(var(--popover));
  }

  .q-menu {
    background: hsl(var(--popover));
    border-color: hsl(var(--border));
    color: hsl(var(--foreground));
  }

  .q-select__dialog {
    background: hsl(var(--popover));
    color: hsl(var(--popover-foreground));
    border: 1px solid hsl(var(--border));
  }

  .q-select__dialog .q-item,
  .q-select__dialog .q-item__section,
  .q-select__dialog .q-item__label,
  .q-select__dialog .q-field__native {
    color: inherit;
  }

  .q-uploader {
    background: hsl(var(--popover));
    color: hsl(var(--popover-foreground));
    border-color: hsl(var(--border));
  }

  .q-uploader__list,
  .q-uploader__dnd {
    background: hsl(var(--popover));
    color: hsl(var(--popover-foreground));
  }

  .q-field,
  .q-field__native,
  .q-field__input,
  .q-field__marginal,
  .q-select__dropdown-icon {
    color: hsl(var(--foreground));
  }

  .q-field__label {
    color: hsl(var(--muted-foreground));
  }

  .q-checkbox__inner {
    color: rgba(255, 255, 255, 0.55);
  }

  .q-checkbox__inner--truthy,
  .q-checkbox__inner--indet {
    color: hsl(var(--primary));
  }
}

// --------------------------------------------
// Dialogs (q-dialog) - shadcn-vue conventions
// --------------------------------------------
.q-dialog {
  &__backdrop {
    background: rgba(0, 0, 0, 0.5);
    backdrop-filter: blur(2px);
  }
}

// --------------------------------------------
// Chips/Badges (q-chip) - shadcn-vue conventions
// --------------------------------------------
.q-chip {
  border-radius: var(--radius-full); // Full round (9999px)
  font-size: 12px; // text-xs
  font-weight: 500;
  padding: 2px 8px; // px-2 py-0.5
  height: auto;
  letter-spacing: var(--tracking-tight);
  transition:
    background-color 0.15s ease,
    border-color 0.15s ease;

  &--square {
    border-radius: var(--radius-sm);
  }

  &--outline {
    border: 1px solid currentColor;
    background: transparent;
  }

  &--clickable:hover {
    opacity: 0.9;
  }
}

// --------------------------------------------
// Badges (q-badge)
// --------------------------------------------
.q-badge {
  border-radius: var(--radius-sm);
  font-weight: 500;
  letter-spacing: var(--tracking-tight);

  &--outline {
    border: var(--border-width) solid currentColor;
  }
}

// --------------------------------------------
// Banners (q-banner)
// --------------------------------------------
.q-banner {
  border-radius: var(--radius);
  border: var(--border-width) solid var(--border-color);

  &--rounded {
    border-radius: var(--radius);
  }

  &--dense {
    padding: 0.75rem 1rem;
  }
}

// --------------------------------------------
// Separators (q-separator) - shadcn-vue conventions
// --------------------------------------------
.q-separator {
  background: hsl(var(--border));

  &--horizontal {
    height: 1px;
  }

  &--vertical {
    width: 1px;
  }

  &--spaced {
    margin: 1rem 0;
  }
}

// --------------------------------------------
// Toolbar (q-toolbar)
// --------------------------------------------
.q-toolbar {
  border-radius: var(--radius);
}

// --------------------------------------------
// List Items (q-item, q-expansion-item)
// --------------------------------------------
.q-item {
  border-radius: var(--radius-md); // Consistent with buttons/inputs
  transition: background-color 0.15s ease;

  &--clickable:hover {
    background: var(--muted);
  }

  &--active {
    background: var(--muted);
  }
}

.q-expansion-item {
  border-radius: var(--radius-md); // Consistent with buttons/inputs

  .q-expansion-item__container {
    border-radius: var(--radius-md);
  }
}

// --------------------------------------------
// Linear Progress (q-linear-progress) - shadcn-vue conventions
// --------------------------------------------
.q-linear-progress {
  height: 8px; // h-2
  border-radius: var(--radius-full);
  background: hsl(var(--primary) / 0.2);
  overflow: hidden;

  &__track {
    border-radius: var(--radius-full);
  }

  &__model {
    background: hsl(var(--primary));
    border-radius: var(--radius-full);
  }
}

// --------------------------------------------
// Skeleton (q-skeleton)
// --------------------------------------------
.q-skeleton {
  border-radius: var(--radius-sm);

  &--type-rect {
    border-radius: var(--radius);
  }

  &--type-circle {
    border-radius: var(--radius-full);
  }
}

// --------------------------------------------
// Tooltip (q-tooltip)
// --------------------------------------------
.q-tooltip {
  border-radius: var(--radius-sm);
  font-size: 0.75rem;
  font-weight: 500;
}

// --------------------------------------------
// Tabs (q-tabs) - shadcn-vue conventions
// --------------------------------------------
.q-tabs {
  .q-tab {
    border-radius: var(--radius-md);

    &--active {
      box-shadow: var(--shadow-sm);
    }
  }
}

.q-tabs__content {
  border-radius: var(--radius-lg);
}

// ============================================
// Typography Adjustments (shadcn-inspired)
// ============================================

h1,
h2,
h3,
h4,
h5,
h6,
.text-h1,
.text-h2,
.text-h3,
.text-h4,
.text-h5,
.text-h6 {
  letter-spacing: -0.02em;
  font-weight: 600;
}

.text-subtitle1 {
  letter-spacing: var(--tracking-tight);
  font-weight: 500;
}

.text-subtitle2 {
  letter-spacing: var(--tracking-tight);
  font-weight: 500;
}

.text-body1,
.text-body2 {
  letter-spacing: var(--tracking-tight);
}

.text-caption {
  letter-spacing: 0;
  color: hsl(var(--muted-foreground));
}

.text-overline {
  letter-spacing: 0.05em;
  font-weight: 500;
  text-transform: uppercase;
  font-size: 0.625rem;
}

.text-weight-thin {
  font-weight: 300;
}

.text-weight-light {
  font-weight: 300;
}

.text-weight-regular {
  font-weight: 400;
}

.text-weight-medium {
  font-weight: 500;
}

.text-weight-bold {
  font-weight: 600;
}

.text-weight-bolder {
  font-weight: 700;
}

// Mobile typography adjustments
@media (max-width: calc(#{$breakpoint-sm-min} - 1px)) {
  .text-h6 {
    font-size: 1rem;
    line-height: 1.25;
  }
}

// ============================================
// Utility Classes (shadcn-inspired)
// ============================================

.text-muted {
  color: hsl(var(--muted-foreground));
}

.bg-muted {
  background-color: hsl(var(--muted));
}

.themed-muted-surface {
  background-color: hsl(var(--muted));
  color: hsl(var(--foreground));
}

.themed-muted-banner {
  background-color: hsl(var(--muted));
  color: hsl(var(--muted-foreground));
  border-color: hsl(var(--border));
}

.border-subtle {
  border: var(--border-width) solid var(--border-color);
}

.shadow-subtle {
  box-shadow: var(--shadow-sm);
}

.shadow-elevated {
  box-shadow: var(--shadow-md);
}

.min-w-0 {
  min-width: 0;
}

.focus-ring {
  &:focus-visible {
    outline: none;
    box-shadow: 0 0 0 3px hsl(var(--ring) / 0.5);
  }
}

// ============================================
// Form Labels (accessible label pattern)
// ============================================

.form-label {
  display: block;
  font-size: 0.875rem;
  font-weight: 500;
  color: var(--text-color);
  margin-bottom: 0.375rem;
  letter-spacing: var(--tracking-tight);
  cursor: pointer;
}

.form-label--required::after {
  content: ' *';
  color: $negative;
}
